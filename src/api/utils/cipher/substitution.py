S_BOX = [
     99, 124, 255, 139,  45,  59,  23, 126,  87, 151,  79, 200,  89, 244, 254,  73,
    121, 152,  10,  69, 117, 114, 182, 243, 109, 238, 168, 210, 173,  24, 101,  88,
    110, 104, 158, 144, 196, 232, 112,  74, 123,  57, 235, 231, 137,  12,  56, 213,
    119, 128, 165, 215, 149, 156, 187, 233,   4,  19, 205,  84, 115,  32, 237, 147,
    246,  51, 230,  95, 142, 175, 154,  64, 163, 167, 181, 174, 234, 108, 228,  35,
    111, 221,  78, 223,  52, 240,  33,  97,  22,   7, 212, 242, 206, 209,  43,  54,
    122,  55, 146, 135,   0,  50,  42, 226,  11, 153, 143, 190,  28,  34,  53,  26,
    208, 236,  72, 132,  39,  37, 248,  70, 107, 192, 194,  85,  36,  31,  27, 150,
    169, 207,  75, 183, 161, 129, 125, 170, 134, 191,   5, 253, 159, 113, 225, 198,
     16, 105,   1, 251,   8,  62, 133, 249, 180, 157, 247, 252, 160,  20,  67, 188,
    118,  29,  47,  77, 245,  63,  46,  48, 219, 227, 185,  25,  66, 224,  98, 177,
    217,  86,  81, 116, 171, 250, 184,  92, 166, 214,  58, 202,  71,  40, 218,  94,
    239,  41,  90, 172, 155, 136,   2,  15, 193,  96, 203, 140, 199, 145, 176, 216,
     68,  65,  30,  60,   6, 201, 141, 102, 220,   3, 195,  61,  91, 197, 204, 222,
    186,  80, 164,  44, 229, 130, 131,  13,  82,  49,  83, 162, 189,  14, 241, 106,
    103, 100, 178,   9, 179,  21, 120,  38, 211, 127,  93, 148,  76,  17, 138,  18
]

INV_S_BOX = [
    100, 146, 198, 217,  56, 138, 212,  89, 148, 243,  18, 104,  45, 231, 237, 199,
    144, 253, 255,  57, 157, 245,  88,   6,  29, 171, 111, 126, 108, 161, 210, 125,
     61,  86, 109,  79, 124, 117, 247, 116, 189, 193, 102,  94, 227,   4, 166, 162,
    167, 233, 101,  65,  84, 110,  95,  97,  46,  41, 186,   5, 211, 219, 149, 165,
     71, 209, 172, 158, 208,  19, 119, 188, 114,  15,  39, 130, 252, 163,  82,  10,
    225, 178, 232, 234,  59, 123, 177,   8,  31,  12, 194, 220, 183, 250, 191,  67,
    201,  87, 174,   0, 241,  30, 215, 240,  33, 145, 239, 120,  77,  24,  32,  80,
     38, 141,  21,  60, 179,  20, 160,  48, 246,  16,  96,  40,   1, 134,   7, 249,
     49, 133, 229, 230, 115, 150, 136,  99, 197,  44, 254,   3, 203, 214,  68, 106,
     35, 205,  98,  63, 251,  52, 127,   9,  17, 105,  70, 196,  53, 153,  34, 140,
    156, 132, 235,  72, 226,  50, 184,  73,  26, 128, 135, 180, 195,  28,  75,  69,
    206, 175, 242, 244, 152,  74,  22, 131, 182, 170, 224,  54, 159, 236, 107, 137,
    121, 200, 122, 218,  36, 221, 143, 204,  11, 213, 187, 202, 222,  58,  92, 129,
    112,  93,  27, 248,  90,  47, 185,  51, 207, 176, 190, 168, 216,  81, 223,  83,
    173, 142, 103, 169,  78, 228,  66,  43,  37,  55,  76,  42, 113,  62,  25, 192,
     85, 238,  91,  23,  13, 164,  64, 154, 118, 151, 181, 147, 155, 139,  14,   2,   
]

def substitute(byte: int, round_key: int) -> int:
    return S_BOX[byte ^ round_key]

def inv_substitute(byte: int, round_key: int) -> int:
    return INV_S_BOX[byte] ^ round_key